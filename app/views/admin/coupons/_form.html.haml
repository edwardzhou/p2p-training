= form_for [:admin, @admin_coupon], :validate => true do |f|
  - if @admin_coupon.errors.any?
    #error_explanation
      %h2
        = pluralize(@admin_coupon.errors.count, "error")
        prohibited this admin_coupon from being saved:
      %ul
        - @admin_coupon.errors.full_messages.each do |msg|
          %li= msg

  .field
    = f.label :coupon_code
    %br/
    = f.text_field :coupon_code
  .field
    = f.label :coupon_name
    %br/
    = f.text_field :coupon_name
  .field
    = f.label :qty
    %br/
    = f.text_field :qty
  .field
    = f.label :discount_type
    %br/
    = f.select :discount_type, {'By Rate' => 1, 'By Price'=> 2}
  .field
    = f.label :discount_rate
    %br/
    = f.text_field :discount_rate
  .field
    = f.label :discount_price
    %br/
    = f.text_field :discount_price
  .field
    = f.label :due_date_date
    %br/
    = f.text_field :due_date_date, :class => "date" , :date => "true"
  .field
    = f.label :disabled
    %br/
    = f.check_box :disabled
  .field
    = f.label :course_id
    %br/
    = f.text_field :course_id, :tokeninput=>true,
                   "data-url" => admin_courses_path(:format => :json),
                   "data-pre" => pre_course(@admin_coupon.course),
                   "data-exclude" => "[campaign_id]"

  .field
    = f.label :campaign_id
    %br/
    = f.text_field :campaign_id, :tokeninput=>true,
                   "data-url" => search_admin_course_campaigns_path(:course_id=>0, :format => :json),
                   "data-pre" => pre_campaign(@admin_coupon.campaign),
                   "data-exclude" => "[course_id]"
  .actions
    = f.submit


- content_for :page_include_scripts do
  = javascript_include_tag 'rails.validations',
                            'i18n/messages-zh-CN',
                            'i18n/jquery.ui.datepicker-zh-CN',
                            'jquery.tokeninput'

- content_for :page_inline_scripts do
  :javascript
    $(document).ready(function(){
      //$("form").validate({errorClass: 'error_msg'});
      $('input[date=true]').datepicker({
        showButtonPanel: true,
        changeYear: true,
        changeMonth: true,
        });
      $('input[tokeninput=true]').each(function(index){
        $(this).tokenInput($(this).data("url"),{
          tokenLimit:1,
          //theme: "facebook"
          onAdd: function(item) {
            exclude_item = $("input[name*='" + $(this).data("exclude") + "']" )[0];
            $(exclude_item).tokenInput("clear");
            $(exclude_item).focus();
          }
        })
      })
    })

- content_for :page_include_css do
  = stylesheet_link_tag "ui-lightness/jquery-ui-1.8.11.custom","token-input", "token-input-mac", "token-input-facebook"

